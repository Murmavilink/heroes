(()=>{"use strict";const e=async()=>{try{let e=await fetch("https://marvelheroesdb-default-rtdb.firebaseio.com/heroes.json");return await e.json()}catch(e){console.log(e)}},t=t=>{const s=document.querySelector(".cards"),o=document.querySelector(".btn");let n=1;const a=e=>{s.innerHTML="",e.forEach((e=>{s.insertAdjacentHTML("beforeend",`\n                <div class="card">\n                   <img class="card__img" src="./db/${e.photo}" alt="${e.name+" img"}">\n                        <h3 class="card__title">${e.name}</h3>\n                </div>`)})),0===e.length&&(s.innerHTML='<span class="text-info">no information about Heroes</span>')},c=()=>{e().then((e=>(e=>{const t=9*n;a(((e,t)=>e.slice(0,t))(e,t)),e.length>t?n++:o.remove()})(e))).catch((e=>console.log(e.message)))};o&&o.addEventListener("click",(()=>{c(),setTimeout((()=>{o.scrollIntoView({block:"center",behavior:"smooth"})}),30)})),t?(o&&o.remove(),a(t)):c()};t(),(()=>{const t=document.querySelector(".cards"),s=document.querySelector(".modal");t.addEventListener("click",(t=>{let o;var n;t.target.classList.contains("cards")||(o=t.target.closest(".card").querySelector(".card__title").textContent),n=o,e().then((e=>{e.forEach((e=>{var t;e.name===n&&(t=e,document.body.classList.add("stop-scrolling"),s.classList.add("modal--show"),s.innerHTML="",s.insertAdjacentHTML("beforeend",`\n        <div class="modal__card">\n            <img class="modal__movie-backdrop" src="./db/${t.photo}" alt="">\n                <h2 class="modal__movie-title">${t.name}</h2>\n                <ul class="modal__movie-info">\n                <li><span>Имя:</span> ${t.actors}</li>\n                ${t.birthDay?`<li><span>День рождения:</span> ${t.birthDay}</li>`:"<li><span>День рождения:</span> &#9785;</li>"}\n                ${t.gender?"<li><span>Пол:</span> "+("male"===t.gender?"Мужской":"Женский"):""}</li>\n                ${t.citizenship?`<li><span>Гражданство: </span> ${t.citizenship}</li>`:""}\n                ${t.movies?`<li><span>Фильмы:</span> ${t.movies.join(", ")}</li>`:""}                    \n                </ul>\n            <button type="button" class="modal__button-close">Закрыть</button>\n        </div>`))}))})).catch((e=>console.log(e.message))),s.addEventListener("click",(e=>{!e.target.classList.contains("modal__button-close")&&e.target.closest(".modal__card")||(s.classList.remove("modal--show"),document.body.classList.remove("stop-scrolling"))})),window.addEventListener("keydown",(e=>{"Escape"===e.key&&(s.classList.remove("modal--show"),document.body.classList.remove("stop-scrolling"))}))}))})(),(()=>{const s=document.getElementById("sort");s.addEventListener("change",(()=>{const o=s.querySelectorAll("select");e().then((e=>{let s=e;o.forEach((e=>{if("noselected"!==e.value){const t=e.id,o=e.value;"movies"===t&&(s=((e,t)=>e.filter((e=>{if(e.movies)return e.movies.includes(t)})))(s,o)),"movies"!==t&&(s=((e,t,s)=>e.filter((e=>{if(e[t])return e[t].toLowerCase()===s.toLowerCase()})))(s,t,o))}})),t(s)})).catch((e=>console.log(e.message)))}))})(),(()=>{const s=document.querySelector(".form-header"),o=document.querySelector(".form-header__search"),n=n=>{s.addEventListener(n,(s=>{var n;s.preventDefault(),n=o.value,e().then((e=>{let s=e;s=((e,t)=>e.filter((e=>e.name.toLowerCase().includes(t))))(e,n.toLowerCase()),t(s)})).catch((e=>console.log(e.message)))}))};n("input"),n("submit")})()})();